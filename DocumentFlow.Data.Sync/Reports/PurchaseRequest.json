{
  "$id": "1",
  "Created": "2020-11-27T22:03:22+04:00",
  "Modified": "2020-11-28T14:15:00+04:00",
  "ReportPage": {
    "$id": "30",
    "Title": "[Title.doc_name]",
    "Report": {
      "$ref": "1"
    },
    "DataBands": {
      "$id": "66",
      "$values": [
        {
          "Footer": {
            "$id": "200",
            "Font": {
              "$id": "201",
              "Name": "Calibri",
              "Size": 12
            },
            "Name": "Footer1",
            "Page": {
              "$ref": "30"
            },
            "Height": 35,
            "TextObjects": {
              "$id": "202",
              "$values": [
                {
                  "$id": "203",
                  "Top": 5,
                  "Band": {
                    "$ref": "200"
                  },
                  "Left": 0,
                  "Name": "Text25",
                  "Text": "Счёт для оплаты прошу выставить по эл. почте:",
                  "Width": 90.5,
                  "Height": 5.5,
                  "Padding": {
                    "$id": "301",
                    "Right": 0
                  },
                  "VerticalAlignment": "Middle"
                },
                {
                  "$id": "204",
                  "Top": 5,
                  "Band": {
                    "$ref": "200"
                  },
                  "Font": {
                    "$id": "205",
                    "Name": "Calibri",
                    "Size": 12,
                    "Style": "Underline"
                  },
                  "Left": 90.5,
                  "Name": "Text29",
                  "Text": "office@autokom.company",
                  "Width": 55,
                  "Height": 5.5,
                  "Padding": {
                    "$id": "302",
                    "Left": 0
                  },
                  "ColorName": "Blue",
                  "VerticalAlignment": "Middle"
                },
                {
                  "$id": "206",
                  "Top": 25,
                  "Band": {
                    "$ref": "200"
                  },
                  "Left": 0,
                  "Name": "Text26",
                  "Text": "[Context.post_name]",
                  "Width": 45,
                  "Height": 5.5,
                  "VerticalAlignment": "Middle"
                },
                {
                  "$id": "207",
                  "Top": 25,
                  "Band": {
                    "$ref": "200"
                  },
                  "Left": 142.5,
                  "Name": "Text27",
                  "Text": "[Context.director]",
                  "Width": 47.5,
                  "Height": 5.5,
                  "VerticalAlignment": "Middle"
                },
                {
                  "$id": "208",
                  "Top": 30,
                  "Band": {
                    "$ref": "200"
                  },
                  "Font": {
                    "$id": "209",
                    "Name": "Calibri",
                    "Size": 8
                  },
                  "Left": 0,
                  "Name": "Text28",
                  "Text": "[Context.phone]",
                  "Width": 45,
                  "Height": 5,
                  "VerticalAlignment": "Middle"
                }
              ]
            }
          },
          "Header": {
            "$id": "48",
            "Font": {
              "$id": "49",
              "Name": "Calibri",
              "Size": 11,
              "Style": "Bold"
            },
            "Name": "Header1",
            "Page": {
              "$ref": "30"
            },
            "Height": 15,
            "TextObjects": {
              "$id": "50",
              "$values": [
                {
                  "$id": "51",
                  "Top": 0,
                  "Band": {
                    "$ref": "48"
                  },
                  "Font": {
                    "$id": "52",
                    "Name": "Calibri",
                    "Size": 12
                  },
                  "Left": 0,
                  "Name": "Text9",
                  "Text": "Прошу Вас отпустить следующую продукцию:",
                  "Width": 190,
                  "Height": 7.5
                },
                {
                  "$id": "53",
                  "Top": 7.5,
                  "Band": {
                    "$ref": "48"
                  },
                  "Fill": {
                    "$id": "68",
                    "ColorName": "LightGray"
                  },
                  "Left": 0,
                  "Name": "Text2",
                  "Text": "Номер",
                  "Width": 17.5,
                  "Height": 7.5,
                  "Borders": {
                    "$id": "54",
                    "All": true,
                    "ColorName": "DarkGray"
                  },
                  "VerticalAlignment": "Middle",
                  "HorizontalAlignment": "Center"
                },
                {
                  "$id": "55",
                  "Top": 7.5,
                  "Band": {
                    "$ref": "48"
                  },
                  "Fill": {
                    "$id": "69",
                    "ColorName": "LightGray"
                  },
                  "Left": 17.5,
                  "Name": "Text4",
                  "Text": "Наименование",
                  "Width": 117.5,
                  "Height": 7.5,
                  "Borders": {
                    "$id": "56",
                    "All": true,
                    "ColorName": "DarkGray"
                  },
                  "VerticalAlignment": "Middle"
                },
                {
                  "$id": "57",
                  "Top": 7.5,
                  "Band": {
                    "$ref": "48"
                  },
                  "Fill": {
                    "$id": "70",
                    "ColorName": "LightGray"
                  },
                  "Left": 135,
                  "Name": "Text6",
                  "Text": "Ед. изм.",
                  "Width": 25,
                  "Height": 7.5,
                  "Borders": {
                    "$id": "58",
                    "All": true,
                    "ColorName": "DarkGray"
                  },
                  "VerticalAlignment": "Middle",
                  "HorizontalAlignment": "Center"
                },
                {
                  "$id": "67",
                  "Top": 7.5,
                  "Band": {
                    "$ref": "48"
                  },
                  "Fill": {
                    "$id": "71",
                    "ColorName": "LightGray"
                  },
                  "Left": 160,
                  "Name": "Text8",
                  "Text": "Количество",
                  "Width": 30,
                  "Height": 7.5,
                  "Borders": {
                    "$id": "72",
                    "All": true,
                    "ColorName": "DarkGray"
                  },
                  "VerticalAlignment": "Middle",
                  "HorizontalAlignment": "Center"
                }
              ]
            }
          },
          "DataBand": {
            "$id": "59",
            "Font": {
              "$id": "60",
              "Name": "Calibri",
              "Size": 12
            },
            "Name": "Data1",
            "Page": {
              "$ref": "30"
            },
            "Height": 7.5,
            "DataSource": "GoodsDetail",
            "TextObjects": {
              "$id": "61",
              "$values": [
                {
                  "$id": "62",
                  "Top": 0,
                  "Band": {
                    "$ref": "59"
                  },
                  "Left": 0,
                  "Name": "Text1",
                  "Text": "[GoodsDetail.row_number]",
                  "Width": 17.5,
                  "Height": 7.5,
                  "Borders": {
                    "$id": "73",
                    "All": true,
                    "ColorName": "DarkGray"
                  },
                  "VerticalAlignment": "Middle",
                  "HorizontalAlignment": "Center"
                },
                {
                  "$id": "63",
                  "Top": 0,
                  "Band": {
                    "$ref": "59"
                  },
                  "Left": 17.5,
                  "Name": "Text2",
                  "Text": "[GoodsDetail.name]",
                  "Width": 117.5,
                  "Height": 7.5,
                  "Borders": {
                    "$id": "74",
                    "All": true,
                    "ColorName": "DarkGray"
                  },
                  "VerticalAlignment": "Middle"
                },
                {
                  "$id": "64",
                  "Top": 0,
                  "Band": {
                    "$ref": "59"
                  },
                  "Left": 135,
                  "Name": "Text5",
                  "Text": "[GoodsDetail.measurement]",
                  "Width": 25,
                  "Height": 7.5,
                  "Borders": {
                    "$id": "75",
                    "All": true,
                    "ColorName": "DarkGray"
                  },
                  "VerticalAlignment": "Middle",
                  "HorizontalAlignment": "Center"
                },
                {
                  "$id": "65",
                  "Top": 0,
                  "Band": {
                    "$ref": "59"
                  },
                  "Left": 160,
                  "Name": "Text7",
                  "Text": "[GoodsDetail.amount]",
                  "Width": 30,
                  "Height": 7.5,
                  "Borders": {
                    "$id": "76",
                    "All": true,
                    "ColorName": "DarkGray"
                  },
                  "VerticalAlignment": "Middle",
                  "HorizontalAlignment": "Right"
                }
              ]
            }
          }
        }
      ]
    },
    "ReportTitleBand": {
      "$id": "31",
      "Font": {
        "$id": "32",
        "Name": "Calibri"
      },
      "Name": "ReportTitle1",
      "Page": {
        "$ref": "30"
      },
      "Height": 72.5,
      "TextObjects": {
        "$id": "33",
        "$values": [
          {
            "$id": "34",
            "Top": 0,
            "Band": {
              "$ref": "31"
            },
            "Font": {
              "$id": "110",
              "Name": "Calibri",
              "Style": "Bold"
            },
            "Left": 0,
            "Name": "Text10",
            "Text": "[Context.org_name]",
            "Width": 90,
            "Height": 10,
            "VerticalAlignment": "Middle",
            "HorizontalAlignment": "Center"
          },
          {
            "$id": "35",
            "Top": 10,
            "Band": {
              "$ref": "31"
            },
            "Left": 0,
            "Name": "Text11",
            "Text": "ИНН: [Context.org_inn], КПП: [Context.org_kpp]",
            "Width": 90,
            "Height": 5,
            "VerticalAlignment": "Middle",
            "HorizontalAlignment": "Center"
          },
          {
            "$id": "36",
            "Top": 15,
            "Band": {
              "$ref": "31"
            },
            "Left": 0,
            "Name": "Text12",
            "Text": "ОГРН: [Context.org_ogrn]",
            "Width": 90,
            "Height": 5,
            "VerticalAlignment": "Middle",
            "HorizontalAlignment": "Center"
          },
          {
            "$id": "37",
            "Top": 20,
            "Band": {
              "$ref": "31"
            },
            "Left": 0,
            "Name": "Text13",
            "Text": "[Context.org_address]",
            "Width": 90,
            "Height": 15,
            "VerticalAlignment": "Middle",
            "HorizontalAlignment": "Center"
          },
          {
            "$id": "38",
            "Top": 35,
            "Band": {
              "$ref": "31"
            },
            "Left": 0,
            "Name": "Text16",
            "Text": "Тел.: [Context.org_phone]",
            "Width": 90,
            "Height": 5,
            "VerticalAlignment": "Middle",
            "HorizontalAlignment": "Center"
          },
          {
            "$id": "39",
            "Top": 40,
            "Band": {
              "$ref": "31"
            },
            "Left": 0,
            "Name": "Text14",
            "Text": "Эл. почта: [Context.org_email]",
            "Width": 90,
            "Height": 5,
            "VerticalAlignment": "Middle",
            "HorizontalAlignment": "Center"
          },
          {
            "$id": "40",
            "Top": 50,
            "Band": {
              "$ref": "31"
            },
            "Left": 5,
            "Name": "Text18",
            "Text": "[Context.doc_date]",
            "Width": 35,
            "Height": 5,
            "Borders": {
              "$id": "104",
              "Bottom": true
            },
            "VerticalAlignment": "Middle",
            "HorizontalAlignment": "Center"
          },
          {
            "$id": "41",
            "Top": 50,
            "Band": {
              "$ref": "31"
            },
            "Left": 40,
            "Name": "Text19",
            "Text": "№",
            "Width": 8.5,
            "Height": 5,
            "VerticalAlignment": "Middle",
            "HorizontalAlignment": "Center"
          },
          {
            "$id": "42",
            "Top": 50,
            "Band": {
              "$ref": "31"
            },
            "Left": 48.5,
            "Name": "Text17",
            "Text": "[Context.doc_number]",
            "Width": 37.5,
            "Height": 5,
            "Borders": {
              "$id": "103",
              "Bottom": true
            },
            "VerticalAlignment": "Middle",
            "HorizontalAlignment": "Center"
          },
          {
            "$id": "43",
            "Top": 57.5,
            "Band": {
              "$ref": "31"
            },
            "Left": 5,
            "Name": "Text20",
            "Text": "На №",
            "Width": 14.5,
            "Height": 5
          },
          {
            "$id": "44",
            "Top": 57.5,
            "Band": {
              "$ref": "31"
            },
            "Left": 19.5,
            "Name": "Text21",
            "Text": "",
            "Width": 23,
            "Height": 5,
            "Borders": {
              "$id": "102",
              "Bottom": true
            }
          },
          {
            "$id": "45",
            "Top": 57.5,
            "Band": {
              "$ref": "31"
            },
            "Left": 42.5,
            "Name": "Text22",
            "Text": "от",
            "Width": 8.5,
            "Height": 5,
            "VerticalAlignment": "Middle",
            "HorizontalAlignment": "Center"
          },
          {
            "$id": "46",
            "Top": 57.5,
            "Band": {
              "$ref": "31"
            },
            "Left": 51,
            "Name": "Text21",
            "Text": "",
            "Width": 35,
            "Height": 5,
            "Borders": {
              "$id": "101",
              "Bottom": true
            }
          },
          {
            "$id": "47",
            "Top": 0,
            "Band": {
              "$ref": "31"
            },
            "Left": 100,
            "Name": "Text24",
            "Text": "[Context.contractor_name]",
            "Width": 90,
            "Height": 10,
            "VerticalAlignment": "Middle",
            "HorizontalAlignment": "Center"
          }
        ]
      }
    }
  },
  "ReportDictionary": {
    "Parameters": {
      "$id": "28",
      "$values": [
        {
          "$id": "29",
          "Name": "OrderId",
          "DataType": "Guid",
          "DefaultValue": "ccca7543-1a91-4c2f-8be3-2d278e3c6071"
        }
      ]
    },
    "Connections": {
      "$id": "2",
      "$values": [
        {
          "$id": "3",
          "Name": "Connection",
          "Sources": {
            "$id": "4",
            "$values": [
              {
                "$id": "5",
                "Name": "Context",
                "Columns": {
                  "$id": "6",
                  "$values": [
                    {
                      "$id": "7",
                      "Name": "contractor_name",
                      "DataType": "string"
                    },
                    {
                      "$id": "8",
                      "Name": "org_name",
                      "DataType": "string"
                    },
                    {
                      "$id": "9",
                      "Name": "org_inn",
                      "DataType": "decimal"
                    },
                    {
                      "$id": "10",
                      "Name": "org_kpp",
                      "DataType": "decimal"
                    },
                    {
                      "$id": "11",
                      "Name": "org_ogrn",
                      "DataType": "decimal"
                    },
                    {
                      "$id": "12",
                      "Name": "org_address",
                      "DataType": "string"
                    },
                    {
                      "$id": "13",
                      "Name": "org_phone",
                      "DataType": "string"
                    },
                    {
                      "$id": "14",
                      "Name": "org_email",
                      "DataType": "string"
                    },
                    {
                      "$id": "15",
                      "Name": "doc_date",
                      "DataType": "string"
                    },
                    {
                      "$id": "16",
                      "Name": "doc_number",
                      "DataType": "string"
                    },
                    {
                      "$id": "17",
                      "Name": "director",
                      "DataType": "string"
                    },
                    {
                      "$id": "18",
                      "Name": "post_name",
                      "DataType": "string"
                    },
                    {
                      "$id": "19",
                      "Name": "phone",
                      "DataType": "string"
                    }
                  ]
                },
                "Parameters": {
                  "$id": "20",
                  "$values": [
                    "OrderId"
                  ]
                },
                "SelectCommand": "with emp as (select e.owner_id, p.name as director, okpdtr.name as post_name, e.phone from employee e join person p on (e.person_id = p.id) join okpdtr on (okpdtr.id = e.post_id) where e.post_role = 1) select c.full_name as contractor_name, o.full_name as org_name, o.inn as org_inn, o.kpp as org_kpp, o.ogrn as org_ogrn, o.address as org_address, o.phone as org_phone, o.email as org_email, to_char(pr.doc_date, 'DD.MM.YYYY') as doc_date, pr.doc_number, emp.director, emp.post_name, emp.phone from purchase_request pr join organization o on (pr.organization_id = o.id) left join contractor c on (pr.contractor_id = c.id) left join emp on (emp.owner_id = o.id) where pr.id = :OrderId"
              },
              {
                "$id": "21",
                "Name": "GoodsDetail",
                "Columns": {
                  "$id": "22",
                  "$values": [
                    {
                      "$id": "23",
                      "Name": "row_number",
                      "DataType": "int"
                    },
                    {
                      "$id": "24",
                      "Name": "name",
                      "DataType": "string"
                    },
                    {
                      "$id": "25",
                      "Name": "measurement",
                      "DataType": "string"
                    },
                    {
                      "$id": "26",
                      "Name": "amount",
                      "DataType": "decimal"
                    }
                  ]
                },
                "Parameters": {
                  "$id": "27",
                  "$values": [
                    "OrderId"
                  ]
                },
                "SelectCommand": "select row_number() over(), g.name, m.abbreviation as measurement, prd.amount from purchase_request_detail prd join goods g on(prd.goods_id = g.id) join measurement m on(g.measurement_id = m.id) where prd.owner_id = :OrderId::uuid"
              },
              {
                "$id": "400",
                "Name": "Title",
                "Columns": {
                  "$id": "401",
                  "$values": [
                    {
                      "$id": "402",
                      "Name": "doc_name",
                      "DataType": "string"
                    }
                  ]
                },
                "Parameters": {
                  "$id": "403",
                  "$values": [
                    "OrderId"
                  ]
                },
                "SelectCommand": "select 'Заказ №' || d.doc_number || ' от ' || to_char(d.doc_date, 'DD.MM.YYYY') as doc_name from document d where d.id = :OrderId"
              }
            ]
          },
          "ConnectionStringType": "Current"
        }
      ]
    }
  }
}