{
  "name": "calculation",
  "viewer": {
    "dataset": {
      "select": "select c.id, c.status_id, s.note as status_name, c.code, c.name, c.cost, c.profit_percent, c.profit_value, c.price, c.note from calculation c join status s on (s.id = c.status_id) where c.owner_id = :owner_id",
      "select-id": "select c.id, c.status_id, s.note as status_name, c.code, c.name, c.cost, c.profit_percent, c.profit_value, c.price, c.note from calculation c join status s on (s.id = c.status_id) where c.id = :id"
    },
    "data-type": "Directory",
    "toolbar": {
      "button-style": "Image",
      "icon-size": "Small"
    },
    "commandbar-visible": false,
    "columns": [
      {
        "datafield": "id",
        "text": "Id",
        "type": "Text",
        "width": 180,
        "visible": false
      },
      {
        "datafield": "status_id",
        "text": "Код состояния",
        "type": "Integer",
        "width": 80,
        "visible": false
      },
      {
        "datafield": "status_name",
        "text": "Состояние",
        "type": "Text",
        "width": 110,
        "visible": false
      },
      {
        "datafield": "code",
        "text": "Код",
        "type": "Text",
        "width": 150
      },
      {
        "datafield": "name",
        "text": "Наименование",
        "type": "Text",
        "hideable": false,
        "auto-size": true
      },
      {
        "datafield": "cost",
        "text": "Себестоимость",
        "type": "Numeric",
        "width": 150,
        "format-mode": "Currency",
        "horizontal-align": "Right"
      },
      {
        "datafield": "profit_percent",
        "text": "Прибыль, %",
        "type": "Numeric",
        "width": 120,
        "format-mode": "Percent",
        "horizontal-align": "Center"
      },
      {
        "datafield": "profit_value",
        "text": "Прибыль",
        "type": "Numeric",
        "width": 150,
        "format-mode": "Currency",
        "horizontal-align": "Right"
      },
      {
        "datafield": "price",
        "text": "Цена",
        "type": "Numeric",
        "width": 150,
        "format-mode": "Currency",
        "horizontal-align": "Right"
      }
    ]
  },
  "editor": {
    "dataset": {
      "select": "select c.id, g.name as goods_name, c.code, c.name, c.cost, c.profit_percent, c.profit_value, c.price, c.note from calculation c join goods g on (g.id = c.owner_id) where c.id = :id",
      "update": "update calculation set code = :code, name = :name, cost = :cost, profit_percent = :profit_percent, profit_value = :profit_value, price = :price, note = :note where id = :id"
    },
    "controls": [
      {
        "type": "TextBox",
        "text": "Продукция",
        "datafield": "goods_name",
        "label-width": 130,
        "edit-width": 300,
        "enabled": false
      },
      {
        "type": "TextBox",
        "text": "Код",
        "datafield": "code",
        "label-width": 130,
        "edit-width": 160
      },
      {
        "type": "TextBox",
        "text": "Наименование",
        "datafield": "name",
        "label-width": 130,
        "edit-width": 400
      },
      {
        "type": "Currency",
        "text": "Себестоимость",
        "datafield": "cost",
        "label-width": 130,
        "edit-width": 130
      },
      {
        "type": "Percent",
        "text": "Рентабельность",
        "datafield": "profit_percent",
        "label-width": 130,
        "edit-width": 70,
        "decimal-digits": 2
      },
      {
        "type": "Currency",
        "text": "Прибыль",
        "datafield": "profit_value",
        "label-width": 130
      },
      {
        "type": "Currency",
        "text": "Цена",
        "datafield": "price",
        "label-width": 130
      },
      {
        "type": "TextBox",
        "text": "Описание",
        "datafield": "note",
        "label-width": 130,
        "edit-width": 400,
        "height": 75,
        "multiline": true
      }
    ],
    "conditions": [
      {
        "controls": [ "code", "name", "cost", "profit_percent", "profit_value", "price", "note" ],
        "enable": {
          "states": [ "compiled", "is changing" ]
        }
      }
    ],
    "childs": [
      {
        "name": "view-item-goods"
      },
      {
        "name": "view-item-oper"
      },
      {
        "name": "view-item-deduction"
      }
    ]
  }
}