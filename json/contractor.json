{
  "name": "contractor",
  "viewer": {
    "dataset": {
      "select": "select c.id, c.status_id, s.note as status_name, c.name, c.parent_id, c.short_name, c.full_name, c.inn, c.kpp, c.ogrn, c.okpo, o.name as okopf_name, c.tax_payer, c.supplier, c.buyer from contractor c join status s on (s.id = c.status_id) left join okopf o on (o.id = c.okopf_id) where (c.parent_id is not distinct from :parent_id)",
      "select-id": "select c.id, c.status_id, s.note as status_name, c.name, c.parent_id, c.short_name, c.full_name, c.inn, c.kpp, c.ogrn, c.okpo, o.name as okopf_name, c.tax_payer, c.supplier, c.buyer from contractor c join status s on (s.id = c.status_id) left join okopf o on (o.id = c.okopf_id) where c.id = :id"
    },
    "data-type": "Directory",
    "allow-grouping": true,
    "columns": [
      {
        "datafield": "id",
        "text": "Id",
        "type": "Text",
        "width": 180,
        "visible": false
      },
      {
        "datafield": "status_id",
        "text": "Код состояния",
        "type": "Integer",
        "width": 80,
        "visible": false,
        "allow-grouping": true
      },
      {
        "datafield": "status_name",
        "text": "Состояние",
        "type": "Text",
        "width": 110,
        "visible": false,
        "allow-grouping": true
      },
      {
        "datafield": "name",
        "text": "Наименование",
        "type": "Text",
        "hideable": false,
        "auto-size": true
      },
      {
        "datafield": "short_name",
        "text": "Краткое наименование",
        "type": "Text",
        "width": 150,
        "visible": false
      },
      {
        "datafield": "full_name",
        "text": "Полное наименование",
        "type": "Text",
        "width": 200,
        "visible": false
      },
      {
        "datafield": "inn",
        "text": "ИНН",
        "type": "Integer"
      },
      {
        "datafield": "kpp",
        "text": "КПП",
        "type": "Integer"
      },
      {
        "datafield": "okpo",
        "text": "ОКПО",
        "type": "Integer",
        "visible": false
      },
      {
        "datafield": "ogrn",
        "text": "ОГРН",
        "type": "Integer",
        "width": 120
      },
      {
        "datafield": "okopf_name",
        "text": "ОКОПФ",
        "type": "Text",
        "width": 300,
        "allow-grouping": true
      },
      {
        "datafield": "tax_payer",
        "text": "Плательщик НДС",
        "type": "Boolean",
        "visible": false,
        "allow-grouping": true
      },
      {
        "datafield": "supplier",
        "text": "Поставщик",
        "type": "Boolean",
        "visible": false,
        "allow-grouping": true
      },
      {
        "datafield": "buyer",
        "text": "Покупатель",
        "type": "Boolean",
        "visible": false,
        "allow-grouping": true
      }
    ]
  },
  "editor": {
    "dataset": {
      "select": "select id, name, parent_id, short_name, full_name, inn, kpp, ogrn, okpo, okopf_id, account_id, tax_payer, supplier, buyer from contractor where id = :id",
      "update": "update contractor set name = :name, parent_id = :parent_id, short_name = :short_name, full_name = :full_name, inn = :inn, kpp = :kpp, ogrn = :ogrn, okpo = :okpo, okopf_id = :okopf_id, account_id = :account_id, tax_payer = :tax_payer, supplier = :supplier, buyer = :buyer where id = :id"
    },
    "controls": [
      {
        "type": "TextBox",
        "text": "Наименование",
        "datafield": "name",
        "label-width": 190,
        "edit-width": 360
      },
      {
        "type": "SelectBox",
        "text": "Группа",
        "datafield": "parent_id",
        "dataset": "select id, parent_id, name, status_id from contractor where status_id = 500 order by name",
        "select-view": "Folder",
        "label-width": 190,
        "edit-width": 360
      },
      {
        "type": "TextBox",
        "text": "Короткое наименование",
        "datafield": "short_name",
        "label-width": 190,
        "edit-width": 450
      },
      {
        "type": "TextBox",
        "text": "Полное наименование",
        "datafield": "full_name",
        "label-width": 190,
        "edit-width": 450,
        "height": 75,
        "multiline": true,
        "padding": [ 0, 0, 0, 7 ]
      },
      {
        "type": "Numeric",
        "text": "ИНН",
        "datafield": "inn",
        "label-width": 190,
        "edit-width": 150,
        "decimal-digits": 0
      },
      {
        "type": "Numeric",
        "text": "КПП",
        "datafield": "kpp",
        "label-width": 190,
        "edit-width": 150,
        "decimal-digits": 0
      },
      {
        "type": "Numeric",
        "text": "ОГРН",
        "datafield": "ogrn",
        "label-width": 190,
        "edit-width": 150,
        "decimal-digits": 0
      },
      {
        "type": "Numeric",
        "text": "ОКПО",
        "datafield": "okpo",
        "label-width": 190,
        "edit-width": 150,
        "decimal-digits": 0
      },
      {
        "type": "ComboBoxData",
        "text": "ОКОПФ",
        "datafield": "okopf_id",
        "label-width": 190,
        "edit-width": 330,
        "dataset": "select id, name from okopf where status_id = 1001 order by name"
      },
      {
        "type": "ComboBoxData",
        "text": "Расчётный счёт",
        "datafield": "account_id",
        "label-width": 190,
        "edit-width": 330,
        "dataset": "select id, name from account where (owner_id = :id and status_id = 1002) or (id = :account_id)"
      },
      {
        "type": "CheckBox",
        "text": "Плательщик НДС",
        "datafield": "tax_payer",
        "label-width": 190,
        "height": 32
      },
      {
        "type": "CheckBox",
        "text": "Поставщик",
        "datafield": "supplier",
        "label-width": 190
      },
      {
        "type": "CheckBox",
        "text": "Покупатель",
        "datafield": "buyer",
        "label-width": 190
      }
    ],
    "conditions": [
      {
        "controls": [ "name", "parent_id", "short_name", "full_name", "inn", "kpp", "ogrn", "okpo", "okopf_id", "account_id", "tax_payer", "supplier", "buyer" ],
        "enable": {
          "states": [ "compiled", "is changing" ]
        }
      }
    ],
    "childs": [
      {
        "name": "account"
      },
      {
        "name": "employee"
      },
      {
        "name": "balance_contractor"
      }
    ]
  }
}