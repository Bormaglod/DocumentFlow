{
  "title": "select 'Заказ №' || d.doc_number || ' от ' || to_char(d.doc_date, 'DD.MM.YYYY') as title from document d where d.id = :id",
  "datasets": [
    {
      "name": "context",
      "sql-query": "with emp as (select e.owner_id, p.name as director, okpdtr.name as post_name, e.phone from employee e join person p on (e.person_id = p.id) join okpdtr on (okpdtr.id = e.post_id) where e.post_role = 1) select c.full_name as contractor_name, o.full_name as org_name, o.inn as org_inn, o.kpp as org_kpp, o.ogrn as org_ogrn, o.address as org_address, o.phone as org_phone, o.email as org_email, to_char(pr.doc_date, 'DD.MM.YYYY') as doc_date, pr.doc_number, emp.director, emp.post_name, emp.phone from purchase_request pr join organization o on (pr.organization_id = o.id) left join contractor c on (pr.contractor_id = c.id) left join emp on (emp.owner_id = o.id) where pr.id = :id",
      "unique-result": true
    },
    {
      "name": "request_list",
      "sql-query": "select row_number() over (), g.name, m.abbreviation as measurement, prd.amount from purchase_request_detail prd join goods g on (prd.goods_id = g.id) join measurement m on (g.measurement_id = m.id) where prd.owner_id = :id"
    }
  ]
}